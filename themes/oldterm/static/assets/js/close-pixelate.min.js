!function(t,e){"use strict";var S=2*Math.PI,D=.25*Math.PI;var r=t.console,a=document.createElement("canvas");function i(t,e){this.img=t;var a=this.canvas=document.createElement("canvas");this.ctx=a.getContext("2d"),a.className=t.className,a.id=t.id,this.render(e),t.parentNode.replaceChild(a,t)}a.getContext&&a.getContext("2d")&&(i.prototype.render=function(t){this.options=t;var e=this.width=this.canvas.width=this.img.width,a=this.height=this.canvas.height=this.img.height;this.ctx.drawImage(this.img,0,0);try{this.imgData=this.ctx.getImageData(0,0,e,a).data}catch(t){return void(r&&r.error(t))}this.ctx.clearRect(0,0,e,a);for(var i=0,s=t.length;i<s;i++)this.renderClosePixels(t[i])},i.prototype.renderClosePixels=function(t){var e,a,i,s,r,h,o,c,n,l,d,g,m=this.width,f=this.height,p=this.ctx,x=this.imgData,v=t.resolution||16,u=t.size||v,b=t.alpha||1,w=t.offset||0,y=0,M=0,P=m/v+1,C=f/v+1,j=u/2,I=u/Math.SQRT2,R=I/2;for(a=w,"[object Object]"===Object.prototype.toString.call(a)?(y=w.x||0,M=w.y||0):(e=w,"[object Array]"===Object.prototype.toString.call(e)?(y=w[0]||0,M=w[1]||0):y=M=w),i=0;i<C;i++)for(h=(i-.5)*v+M,o=Math.max(Math.min(h,f-1),0),s=0;s<P;s++)switch(r=(s-.5)*v+y,n=x[(c=4*(Math.max(Math.min(r,m-1),0)+o*m))+0],l=x[c+1],d=x[c+2],g=b*(x[c+3]/255),p.fillStyle="rgba("+n+","+l+","+d+","+g+")",t.shape){case"circle":p.beginPath(),p.arc(r,h,j,0,S,!0),p.fill(),p.closePath();break;case"diamond":p.save(),p.translate(r,h),p.rotate(D),p.fillRect(-R,-R,I,I),p.restore();break;default:p.fillRect(r-j,h-j,u,u)}},HTMLImageElement.prototype.closePixelate=function(t){return new i(this,t)},t.ClosePixelation=i)}(window);